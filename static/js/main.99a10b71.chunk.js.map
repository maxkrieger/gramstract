{"version":3,"sources":["App.tsx","reportWebVitals.ts","index.tsx"],"names":["getArticleIds","start","a","params","db","retmax","toString","retstart","retmode","sort","term","search","URLSearchParams","fetch","res","json","esearchresult","idlist","getArticleMeta","ids","id","join","mode","result","console","error","cleanResult","meta","pii","articleids","find","idtype","value","img","replaced","replace","getImageURL","attributes","length","imgSrc","title","status","recordstatus","uid","App","useState","articles","setArticles","startIdx","setStartIdx","loadState","setLoadState","imageSize","setImageSize","hoverId","setHoverId","useEffect","metas","mapped","map","filter","item","removeIdx","useCallback","idx","articleId","newArticles","splice","onRequestMore","s","concat","style","width","height","overflow","display","flexDirection","justifyContent","margin","padding","fontSize","type","min","max","onChange","e","parseInt","target","flexWrap","flex","article","href","onMouseOver","position","zIndex","backgroundColor","boxShadow","onError","src","alt","alignItems","onClick","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"6NAGMA,EAAa,uCAAG,WAAOC,GAAP,uBAAAC,EAAA,6DACdC,EAAS,CACbC,GAAI,SACJC,OAJU,KAIIC,WACdC,SAAUN,EAAMK,WAChBE,QAAS,OACTC,KAAM,OACNC,KAAK,mBAEDC,EAAS,IAAIC,gBAAgBT,GAAQG,WATvB,SAUFO,MAAM,8DAAD,OACyCF,IAX5C,cAUdG,EAVc,gBAaDA,EAAIC,OAbH,oBAadA,EAbc,kBAchBA,GAdgB,UAchBA,EAAMC,qBAdU,aAchB,EAAqBC,QAdL,0CAeXF,EAAKC,cAAcC,QAfR,iCAiBb,IAjBa,4CAAH,sDAmBbC,EAAc,uCAAG,WAAOC,GAAP,qBAAAjB,EAAA,6DACfC,EAAS,CACbC,GAAI,SACJI,QAAS,OACTY,GAAID,EAAIE,KAAK,MAETV,EAAS,IAAIC,gBAAgBT,GAAQG,WANtB,kBAQDO,MAAM,+DAAD,OAC0CF,GAC/D,CAAEW,KAAM,SAVS,cAQbR,EARa,gBAYAA,EAAIC,OAZJ,oBAYbA,EAZa,kBAafA,OAbe,EAafA,EAAMQ,QAbS,0CAcVR,EAAKQ,QAdK,iEAiBnBC,QAAQC,MAAR,MAjBmB,kBAkBZ,MAlBY,iCAoBd,MApBc,0DAAH,sDA4BdC,EAAc,SAACC,GACnB,IAAMC,EAAcD,EAAKE,WAAWC,MAClC,SAACV,GAAD,MAA2B,QAAdA,EAAGW,UAChBC,MACIC,EATY,SAACL,GACnB,IAAMM,EAAWN,EAAIO,QAAQ,cAAe,IAC5C,MAAM,gDAAN,OAAuDD,EAAvD,gBAOYE,CAAYR,GACxB,OAA+B,IAA3BD,EAAKU,WAAWC,OACX,KAEF,CACLC,OAAQN,EACRO,MAAOb,EAAKa,MACZC,OAAQd,EAAKe,aACbtB,GAAIO,EAAKgB,IACTf,QAqJWgB,MAjJf,WAAgB,IAAD,EACmBC,mBAAgB,IADnC,mBACNC,EADM,KACIC,EADJ,OAEmBF,mBAAS,GAF5B,mBAENG,EAFM,KAEIC,EAFJ,OAGqBJ,mBAMhC,eATW,mBAGNK,EAHM,KAGKC,EAHL,OAUqBN,mBAAS,KAV9B,mBAUNO,EAVM,KAUKC,EAVL,OAWiBR,mBAAS,IAX1B,mBAWNS,EAXM,KAWGC,EAXH,KAYbC,qBAAU,WACR,sBAAC,gCAAAtD,EAAA,sEACmBF,EAAc,GADjC,cACOmB,EADP,OAECgC,EAAa,oBAFd,SAGqBjC,EAAeC,GAHpC,OAGOsC,EAHP,OAIOC,EAASvC,EACZwC,KAAI,SAACvC,GAAD,OAAQM,EAAY+B,EAAMrC,OAC9BwC,QAAO,SAACC,GAAD,OAAmB,OAATA,KACpBd,EAAYW,GACZP,EAAa,UARd,2CAAD,KAUC,IACH,IAAMW,EAAYC,uBAChB,SAACC,EAAaC,GACZ,IAAMC,EAAW,YAAOpB,GACpBoB,EAAYF,GAAK5C,KAAO6C,GAC1BC,EAAYC,OAAOH,EAAK,GAE1BjB,EAAYmB,KAEd,CAACpB,IAEGsB,EAAgBL,uBAAY,WAChC,sBAAC,gCAAA7D,EAAA,6DACCiD,EAAa,gBADd,SAEmBnD,EAAcgD,EAtGxB,KAoGT,cAEO7B,EAFP,OAGC8B,GAAY,SAACoB,GAAD,OAAOA,EAvGX,OAoGT,SAIqBnD,EAAeC,GAJpC,UAKe,QADRsC,EAJP,gCAMGN,EAAa,2BANhB,2BASOO,EAASvC,EACZwC,KAAI,SAACvC,GAAD,OAAQM,EAAY+B,EAAMrC,OAC9BwC,QAAO,SAACC,GAAD,OAAmB,OAATA,KACpBd,EAAYD,EAASwB,OAAOZ,IAC5BP,EAAa,UAbd,2CAAD,KAeC,CAACH,EAAUF,IACd,OACE,sBACEyB,MAAO,CACLC,MAAO,OACPC,OAAQ,OACRC,SAAU,SACVC,QAAS,OACTC,cAAe,UANnB,UASE,sBAAKL,MAAO,CAAEI,QAAS,OAAQE,eAAgB,iBAA/C,UACE,oBAAIN,MAAO,CAAEO,OAAQ,EAAGC,QAAS,EAAGC,SAAU,QAA9C,8CAGA,8BACE,+CAEE,uBACEC,KAAK,QACLC,IAAI,MACJC,IAAI,OACJnD,MAAOoB,EACPgC,SAAU,SAACC,GAAD,OAAOhC,EAAaiC,SAASD,EAAEE,OAAOvD,MAAO,gBAK/D,sBACEuC,MAAO,CACLI,QAAS,OACTa,SAAU,OACVX,eAAgB,SAChBL,MAAO,OACPiB,KAAM,EACNf,SAAU,QAPd,UAUiB,WAAdxB,GAA8C,IAApBJ,EAASR,QAClC,6BAAKY,IAENJ,EAASa,KAAI,SAAC+B,EAAS1B,GAAV,OACZ,mBACE2B,KAAI,6CAAwCD,EAAQ9D,KAEpDgE,YAAa,kBAAMrC,EAAWmC,EAAQtE,KAHxC,SAKE,sBAAKmD,MAAO,CAAEO,OAAQ,MAAOe,SAAU,YAAvC,UACGvC,IAAYoC,EAAQtE,IACnB,qBACEmD,MAAO,CACLsB,SAAU,WACVC,OAAQ,IACRC,gBAAiB,wBACjBC,UAAW,kCALf,SAQE,6BAAKN,EAAQlD,UAIjB,qBACEyD,QAAS,kBAAMnC,EAAUE,EAAK0B,EAAQtE,KACtC8E,IAAKR,EAAQnD,OACbiC,MAAOpB,EACP+C,IAAKT,EAAQlD,YArBZkD,EAAQtE,OA0BjB,sBACEmD,MAAO,CACLC,MAAO,OACPC,OAAQ,QACRE,QAAS,OACTC,cAAe,SACfC,eAAgB,SAChBuB,WAAY,UAPhB,UAUE,wBAAQC,QAASjC,EAAjB,SACiB,iBAAdlB,EAA+B,aAAe,SAEjD,+BACE,mBAAGyC,KAAK,2CAAR,4BADF,oFC1LKW,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCHdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1Bb,M","file":"static/js/main.99a10b71.chunk.js","sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\n\nconst LIMIT = 100;\nconst getArticleIds = async (start: number): Promise<string[]> => {\n  const params = {\n    db: \"pubmed\",\n    retmax: LIMIT.toString(),\n    retstart: start.toString(),\n    retmode: \"json\",\n    sort: \"date\",\n    term: `\"Cell\"[Journal]`,\n  };\n  const search = new URLSearchParams(params).toString();\n  const res = await fetch(\n    `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?${search}`\n  );\n  const json = await res.json();\n  if (json?.esearchresult?.idlist) {\n    return json.esearchresult.idlist;\n  }\n  return [];\n};\nconst getArticleMeta = async (ids: string[]): Promise<any> => {\n  const params = {\n    db: \"pubmed\",\n    retmode: \"json\",\n    id: ids.join(\",\"),\n  };\n  const search = new URLSearchParams(params).toString();\n  try {\n    const res = await fetch(\n      `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?${search}`,\n      { mode: \"cors\" }\n    );\n    const json = await res.json();\n    if (json?.result) {\n      return json.result;\n    }\n  } catch (e) {\n    console.error(e);\n    return null;\n  }\n  return null;\n};\n\nconst getImageURL = (pii: string) => {\n  const replaced = pii.replace(/[^a-z0-9]/gi, \"\");\n  return `https://ars.els-cdn.com/content/image/1-s2.0-${replaced}-fx1_lrg.jpg`;\n};\n\nconst cleanResult = (meta: any) => {\n  const pii: string = meta.articleids.find(\n    (id: any) => id.idtype === \"pii\"\n  ).value;\n  const img = getImageURL(pii);\n  if (meta.attributes.length === 0) {\n    return null;\n  }\n  return {\n    imgSrc: img,\n    title: meta.title,\n    status: meta.recordstatus,\n    id: meta.uid,\n    pii,\n  };\n};\n\nfunction App() {\n  const [articles, setArticles] = useState<any[]>([]);\n  const [startIdx, setStartIdx] = useState(0);\n  const [loadState, setLoadState] = useState<\n    | \"loading IDs\"\n    | \"loading metadata\"\n    | \"loaded\"\n    | \"loading more\"\n    | \"failed to load, refresh\"\n  >(\"loading IDs\");\n  const [imageSize, setImageSize] = useState(400);\n  const [hoverId, setHoverId] = useState(\"\");\n  useEffect(() => {\n    (async () => {\n      const ids = await getArticleIds(0);\n      setLoadState(\"loading metadata\");\n      const metas = await getArticleMeta(ids);\n      const mapped = ids\n        .map((id) => cleanResult(metas[id]))\n        .filter((item) => item !== null);\n      setArticles(mapped);\n      setLoadState(\"loaded\");\n    })();\n  }, []);\n  const removeIdx = useCallback(\n    (idx: number, articleId: string) => {\n      const newArticles = [...articles];\n      if (newArticles[idx].id === articleId) {\n        newArticles.splice(idx, 1);\n      }\n      setArticles(newArticles);\n    },\n    [articles]\n  );\n  const onRequestMore = useCallback(() => {\n    (async () => {\n      setLoadState(\"loading more\");\n      const ids = await getArticleIds(startIdx + LIMIT);\n      setStartIdx((s) => s + LIMIT);\n      const metas = await getArticleMeta(ids);\n      if (metas === null) {\n        setLoadState(\"failed to load, refresh\");\n        return;\n      }\n      const mapped = ids\n        .map((id) => cleanResult(metas[id]))\n        .filter((item) => item !== null);\n      setArticles(articles.concat(mapped));\n      setLoadState(\"loaded\");\n    })();\n  }, [startIdx, articles]);\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        overflow: \"hidden\",\n        display: \"flex\",\n        flexDirection: \"column\",\n      }}\n    >\n      <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n        <h1 style={{ margin: 0, padding: 0, fontSize: \"18px\" }}>\n          Cell Graphical Abstracts Browser\n        </h1>\n        <div>\n          <label>\n            image size\n            <input\n              type=\"range\"\n              min=\"100\"\n              max=\"1000\"\n              value={imageSize}\n              onChange={(e) => setImageSize(parseInt(e.target.value, 10))}\n            />\n          </label>\n        </div>\n      </div>\n      <div\n        style={{\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          justifyContent: \"center\",\n          width: \"100%\",\n          flex: 1,\n          overflow: \"auto\",\n        }}\n      >\n        {loadState !== \"loaded\" && articles.length === 0 && (\n          <h1>{loadState}</h1>\n        )}\n        {articles.map((article, idx) => (\n          <a\n            href={`https://www.cell.com/cell/fulltext/${article.pii}`}\n            key={article.id}\n            onMouseOver={() => setHoverId(article.id)}\n          >\n            <div style={{ margin: \"5px\", position: \"relative\" }}>\n              {hoverId === article.id && (\n                <div\n                  style={{\n                    position: \"absolute\",\n                    zIndex: 1000,\n                    backgroundColor: \"rgba(255,255,255,0.8)\",\n                    boxShadow: \"var(--shadow-elevation-medium)\",\n                  }}\n                >\n                  <h4>{article.title}</h4>\n                </div>\n              )}\n\n              <img\n                onError={() => removeIdx(idx, article.id)}\n                src={article.imgSrc}\n                width={imageSize}\n                alt={article.title}\n              />\n            </div>\n          </a>\n        ))}\n        <div\n          style={{\n            width: \"100%\",\n            height: \"200px\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n        >\n          <button onClick={onRequestMore}>\n            {loadState === \"loading more\" ? \"loading...\" : \"more\"}\n          </button>\n          <h5>\n            <a href=\"https://github.com/maxkrieger/gramstract\">\n              fork on GitHub\n            </a>\n            . this is unofficial. please support open access however you see fit\n          </h5>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}